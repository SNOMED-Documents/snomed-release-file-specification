# 3.1.5 History Mechanism

The [effectiveTime](https://confluence.ihtsdotools.org/display/DOCRELFMT/effectiveTime+\(field\) "Reference term: effectiveTime \(\(field\)\)") and [active](https://confluence.ihtsdotools.org/display/DOCGLOSS/active "Glossary link: active") fields in the [release file](https://confluence.ihtsdotools.org/display/DOCGLOSS/release+file "Glossary link: release file") enable the use of a "log style" append-only data model to track all changes to each [component](https://confluence.ihtsdotools.org/display/DOCGLOSS/component "Glossary link: component"), providing full traceability. Once released, a row in any of these files will always remain unchanged. Historic data is supplied in the [RF2](https://confluence.ihtsdotools.org/display/DOCGLOSS/RF2 "Glossary link: RF2")[release files](https://confluence.ihtsdotools.org/display/DOCGLOSS/release+file "Glossary link: release files"), dating back to the first release in [RF1](https://confluence.ihtsdotools.org/display/DOCGLOSS/RF1 "Glossary link: RF1") format in 2002.

In order to change the properties of a current [component](https://confluence.ihtsdotools.org/display/DOCGLOSS/component "Glossary link: component") a new version of that component is created with the same identifier. This done by adding a new row to the relevant release file, with the column values updated to represent the changes. The [active](https://confluence.ihtsdotools.org/display/DOCGLOSS/active "Glossary link: active") field must be set to true and the timestamp in the [effectiveTime](https://confluence.ihtsdotools.org/display/DOCRELFMT/effectiveTime+\(field\) "Reference term: effectiveTime \(\(field\)\)") field indicating the nominal date on which the new version was released. Note that the existing row is not changed in any way.

To inactivate a [component](https://confluence.ihtsdotools.org/display/DOCGLOSS/component "Glossary link: component"), a new row is added, containing the same data as the final valid version of the [component](https://confluence.ihtsdotools.org/display/DOCGLOSS/component "Glossary link: component"), but with the [active](https://confluence.ihtsdotools.org/display/DOCGLOSS/active "Glossary link: active") field set to false and the timestamp in the [effectiveTime](https://confluence.ihtsdotools.org/display/DOCRELFMT/effectiveTime+\(field\) "Reference term: effectiveTime \(\(field\)\)") fi eld indicating the nominal date of the release in which the final version ceased being valid. Note again that the existing row is not changed in any way.

Where editorial policy does not allow a particular property of a [component](https://confluence.ihtsdotools.org/display/DOCGLOSS/component "Glossary link: component") to be changed whilst keeping the same [Identifier](https://confluence.ihtsdotools.org/display/DOCGLOSS/Identifier "Glossary link: Identifier"), the [component](https://confluence.ihtsdotools.org/display/DOCGLOSS/component "Glossary link: component") as a whole is inactivated (as described above), and a new row added with a new id, the [effectiveTime](https://confluence.ihtsdotools.org/display/DOCRELFMT/effectiveTime+\(field\) "Reference term: effectiveTime \(\(field\)\)") set to the nominal date of the release in which this version of the [component](https://confluence.ihtsdotools.org/display/DOCGLOSS/component "Glossary link: component") became valid, and the [active](https://confluence.ihtsdotools.org/display/DOCGLOSS/active "Glossary link: active") field set to true.

It is thus possible to see both the current values and any historical values of a [component](https://confluence.ihtsdotools.org/display/DOCGLOSS/component "Glossary link: component") at any point in time.

New content, changes and inactivations must have the [effectiveTime](https://confluence.ihtsdotools.org/display/DOCRELFMT/effectiveTime+\(field\) "Reference term: effectiveTime \(\(field\)\)") for the release that it appears in. Pre-releases for testing may set the effectiveTime as the date of the future scheduled release but in general the effectiveTime must not be later that the scheduled release data, Where there is a business requirement for specifying a future activation date for some [components](https://confluence.ihtsdotools.org/display/DOCGLOSS/component "Glossary link: components"), this may be represented using [reference sets](https://confluence.ihtsdotools.org/display/DOCGLOSS/reference+set "Glossary link: reference sets").  

The following example demonstrates how the _history mechanism_ works on the [Concept](https://confluence.ihtsdotools.org/display/DOCRELFMT/Concept+file "Reference term: Concept file"), but the same rules apply equally well to the [Description](https://confluence.ihtsdotools.org/display/DOCGLOSS/Description "Glossary link: Description"),[Relationship](https://confluence.ihtsdotools.org/display/DOCGLOSS/Relationship "Glossary link: Relationship") and [Reference set](https://confluence.ihtsdotools.org/display/DOCGLOSS/Reference+set "Glossary link: Reference set") member files. In this example, the [descriptions](https://confluence.ihtsdotools.org/display/DOCGLOSS/description "Glossary link: descriptions") associated with the [moduleId](https://confluence.ihtsdotools.org/display/DOCRELFMT/moduleId+\(field\) "Reference term: moduleId \(\(field\)\)") and [definitionStatusId](https://confluence.ihtsdotools.org/display/DOCRELFMT/definitionStatusId+\(field\) "Reference term: definitionStatusId \(\(field\)\)") have been shown in place of their [SCTID](https://confluence.ihtsdotools.org/display/DOCRELFMT/SCTID+\(data+type\) "Reference term: SCTID \(\(data type\)\)") values.

A new [concept](https://confluence.ihtsdotools.org/display/DOCGLOSS/concept "Glossary link: concept") (101291009) is ad ded on the 1st July 2007: 

Table 3.1.5-1: History Example - Concept Added

**Id**| [effectiveTime](https://confluence.ihtsdotools.org/display/DOCRELFMT/effectiveTime+\(field\) "Reference term: effectiveTime \(\(field\)\)")|  [active](https://confluence.ihtsdotools.org/display/DOCGLOSS/active "Glossary link: active") | [moduleId](https://confluence.ihtsdotools.org/display/DOCRELFMT/moduleId+\(field\) "Reference term: moduleId \(\(field\)\)")| [definitionStatusId](https://confluence.ihtsdotools.org/display/DOCRELFMT/definitionStatusId+\(field\) "Reference term: definitionStatusId \(\(field\)\)")  
---|---|---|---|---  
101291009| 20070701| 1|  [ | Module 1|](http://snomed.org/fictid# "\(eg:\)  | Module 1 |") |  [ 900000000000074008 | Primitive|](http://snomed.info/id/900000000000074008 "900000000000074008 | Primitive |")  
  
In the following release (on 1st January 2008), the [concept](https://confluence.ihtsdotools.org/display/DOCGLOSS/concept "Glossary link: concept") is moved from |Module 1| to |Module 2|. Because the moduleId field is not immutable, the [concept](https://confluence.ihtsdotools.org/display/DOCGLOSS/concept "Glossary link: concept") may be updated simply by adding a new record with the same Id. 

Table 3.1.5-2: History Example - Module Change

**Id**| [effectiveTime](https://confluence.ihtsdotools.org/display/DOCRELFMT/effectiveTime+\(field\) "Reference term: effectiveTime \(\(field\)\)")|  [active](https://confluence.ihtsdotools.org/display/DOCGLOSS/active "Glossary link: active") | [moduleId](https://confluence.ihtsdotools.org/display/DOCRELFMT/moduleId+\(field\) "Reference term: moduleId \(\(field\)\)")| [definitionStatusId](https://confluence.ihtsdotools.org/display/DOCRELFMT/definitionStatusId+\(field\) "Reference term: definitionStatusId \(\(field\)\)")  
---|---|---|---|---  
101291009| 20070701| 1|  [ | Module 1|](http://snomed.org/fictid# "\(eg:\)  | Module 1 |") |  [ 900000000000074008 | Primitive|](http://snomed.info/id/900000000000074008 "900000000000074008 | Primitive |")  
101291009| 20080101| 1|  [ | Module 2|](http://snomed.org/fictid# "\(eg:\)  | Module 2 |") |  [ 900000000000074008 | Primitive|](http://snomed.info/id/900000000000074008 "900000000000074008 | Primitive |")  
  
In the following release (on 1st July 2008), the [concept](https://confluence.ihtsdotools.org/display/DOCGLOSS/concept "Glossary link: concept") is changed from being [Primitive](https://confluence.ihtsdotools.org/display/DOCGLOSS/Primitive "Glossary link: Primitive") to being [Fully defined](https://confluence.ihtsdotools.org/display/DOCGLOSS/Fully+defined "Glossary link: Fully defined"). 

Table 3.1.5-3: History Example - Definition Status Changed

**Id**| [effectiveTime](https://confluence.ihtsdotools.org/display/DOCRELFMT/effectiveTime+\(field\) "Reference term: effectiveTime \(\(field\)\)")|  [active](https://confluence.ihtsdotools.org/display/DOCGLOSS/active "Glossary link: active") | [moduleId](https://confluence.ihtsdotools.org/display/DOCRELFMT/moduleId+\(field\) "Reference term: moduleId \(\(field\)\)")| [definitionStatusId](https://confluence.ihtsdotools.org/display/DOCRELFMT/definitionStatusId+\(field\) "Reference term: definitionStatusId \(\(field\)\)")  
---|---|---|---|---  
101291009| 20070701| 1|  [ | Module 1|](http://snomed.org/fictid# "\(eg:\)  | Module 1 |") |  [ 900000000000074008 | Primitive|](http://snomed.info/id/900000000000074008 "900000000000074008 | Primitive |")  
101291009| 20080101| 1|  [ | Module 2|](http://snomed.org/fictid# "\(eg:\)  | Module 2 |") |  [ 900000000000074008 | Primitive|](http://snomed.info/id/900000000000074008 "900000000000074008 | Primitive |")  
101291009| 20080701| 1|  [ | Module 2|](http://snomed.org/fictid# "\(eg:\)  | Module 2 |") |  [ 900000000000073002 | Defined|](http://snomed.info/id/900000000000073002 "900000000000073002 | Defined |")  
  
In the following release (on 1st January 2009), the [concept](https://confluence.ihtsdotools.org/display/DOCGLOSS/concept "Glossary link: concept") is deactivated: 

Table 3.1.5-4: History Example - Concept Made Inactive 

**Id**| [effectiveTime](https://confluence.ihtsdotools.org/display/DOCRELFMT/effectiveTime+\(field\) "Reference term: effectiveTime \(\(field\)\)")|  [active](https://confluence.ihtsdotools.org/display/DOCGLOSS/active "Glossary link: active") | [moduleId](https://confluence.ihtsdotools.org/display/DOCRELFMT/moduleId+\(field\) "Reference term: moduleId \(\(field\)\)")| [definitionStatusId](https://confluence.ihtsdotools.org/display/DOCRELFMT/definitionStatusId+\(field\) "Reference term: definitionStatusId \(\(field\)\)")  
---|---|---|---|---  
101291009| 20070701| 1|  [ | Module 1|](http://snomed.org/fictid# "\(eg:\)  | Module 1 |") |  [ 900000000000074008 | Primitive|](http://snomed.info/id/900000000000074008 "900000000000074008 | Primitive |")  
101291009| 20080101| 1|  [ | Module 2|](http://snomed.org/fictid# "\(eg:\)  | Module 2 |") |  [ 900000000000074008 | Primitive|](http://snomed.info/id/900000000000074008 "900000000000074008 | Primitive |")  
101291009| 20080701| 1|  [ | Module 2|](http://snomed.org/fictid# "\(eg:\)  | Module 2 |") |  [ 900000000000073002 | Defined|](http://snomed.info/id/900000000000073002 "900000000000073002 | Defined |")  
101291009| 20090101| 0|  [ | Module 2|](http://snomed.org/fictid# "\(eg:\)  | Module 2 |") |  [ 900000000000074008 | Primitive|](http://snomed.info/id/900000000000074008 "900000000000074008 | Primitive |")  
  
### Notes

  1. At no stage in this process are previously written records ever amended. Once a record has been released in a [release file](https://confluence.ihtsdotools.org/display/DOCGLOSS/release+file "Glossary link: release file"), it will continue to be released in exactly the same form in future [release files](https://confluence.ihtsdotools.org/display/DOCGLOSS/release+file "Glossary link: release files").

  2. Changes are only recorded at the point of release in the [RF2](https://confluence.ihtsdotools.org/display/DOCGLOSS/RF2 "Glossary link: RF2")[release files](https://confluence.ihtsdotools.org/display/DOCGLOSS/release+file "Glossary link: release files"). If a [component](https://confluence.ihtsdotools.org/display/DOCGLOSS/component "Glossary link: component") record is changed a number of times between releases (during an edit and review process), only the most recently amended record will be appended to the [release file](https://confluence.ihtsdotools.org/display/DOCGLOSS/release+file "Glossary link: release file"), not individual records showing each separate edit to the released [component](https://confluence.ihtsdotools.org/display/DOCGLOSS/component "Glossary link: component").

  3. In the last example, as well as inactivating the concept (active=0), the [definitionStatusId](https://confluence.ihtsdotools.org/display/DOCRELFMT/definitionStatusId+\(field\) "Reference term: definitionStatusId \(\(field\)\)") is changed from [ 900000000000073002 | Defined|](http://snomed.info/id/900000000000073002 "900000000000073002 | Defined |") to [ 900000000000074008 | Primitive|](http://snomed.info/id/900000000000074008 "900000000000074008 | Primitive |") . In practice this change is not essential since the value of data columns is ignored when a [component](https://confluence.ihtsdotools.org/display/DOCGLOSS/component "Glossary link: component") is inactive. Although the change is unnecessary and insignificant, it typically occurs since all the relationships of an inactive concept must also be inactive, and as a result, from the perspective of the authoring environment the concept cannot be regarded as [ 900000000000073002 | Defined|](http://snomed.info/id/900000000000073002 "900000000000073002 | Defined |") .

