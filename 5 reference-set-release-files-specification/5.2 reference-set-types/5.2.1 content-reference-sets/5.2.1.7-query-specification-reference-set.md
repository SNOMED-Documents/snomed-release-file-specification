# 5.2.1.7 Query Specification Reference Set

# Purpose

A [ 900000000000512005 | Query specification type reference set|](http://snomed.info/id/900000000000512005 "900000000000512005 | Query specification type reference set |") allows a serialised query to represent the membership of a subset of [SNOMED CT components](https://confluence.ihtsdotools.org/display/DOCGLOSS/SNOMED+CT+component "Glossary link: SNOMED CT components"). A [query](https://confluence.ihtsdotools.org/display/WIPRELFMT/query+\(field\)) contained in the [reference set](https://confluence.ihtsdotools.org/display/DOCGLOSS/reference+set "Glossary link: reference set") is run against the content of [SNOMED CT](https://confluence.ihtsdotools.org/display/DOCGLOSS/SNOMED+CT "Glossary link: SNOMED CT") to produce a subset of [concepts](https://confluence.ihtsdotools.org/display/DOCGLOSS/concept "Glossary link: concepts"), [descriptions](https://confluence.ihtsdotools.org/display/DOCGLOSS/description "Glossary link: descriptions") or [relationships](https://confluence.ihtsdotools.org/display/DOCGLOSS/relationship "Glossary link: relationships"). The query is referred to an intensional definition of the subset. It can be run against future releases of [SNOMED CT](https://confluence.ihtsdotools.org/display/DOCGLOSS/SNOMED+CT "Glossary link: SNOMED CT") to generate an updated set of subset members.

The members of the resulting subset may also be represented in an enumerated form as a [Simple reference set](https://confluence.ihtsdotools.org/display/DOCGLOSS/Simple+reference+set "Glossary link: Simple reference set") . An enumerated representation of a subset is referred to as an extensional definition.

# Data structure

A [Query specification reference set](https://confluence.ihtsdotools.org/display/DOCGLOSS/Query+specification+reference+set "Glossary link: Query specification reference set") is a [String](https://confluence.ihtsdotools.org/display/DOCRELFMT/String+\(data+type\) "Reference term: String \(\(data type\)\)") [reference set](https://confluence.ihtsdotools.org/display/DOCGLOSS/reference+set "Glossary link: reference set") containing [query](https://confluence.ihtsdotools.org/display/DOCRELFMT/query+\(field\) "Reference term: query \(\(field\)\)") that represent intensional definitions of subsets of [components](https://confluence.ihtsdotools.org/display/DOCGLOSS/component "Glossary link: components"). The result of running the [query](https://confluence.ihtsdotools.org/display/WIPRELFMT/query+\(field\)) is an extensional representation of the subset of [components](https://confluence.ihtsdotools.org/display/DOCGLOSS/component "Glossary link: components") which can be represented as a [Simple reference set](https://confluence.ihtsdotools.org/display/DOCGLOSS/Simple+reference+set "Glossary link: Simple reference set"). Its structure is shown in the following table. 

Table 5.2.1.7-1: Query specification reference set - Data structure

**Field**| **Data type**| **Purpose**| **[Mutable](https://confluence.ihtsdotools.org/display/DOCGLOSS/Mutable "Glossary link: Mutable")**| **Part of Primary Key**  
---|---|---|---|---  
id| [UUID](https://confluence.ihtsdotools.org/display/DOCRELFMT/UUID+\(data+type\) "Reference term: UUID \(\(data type\)\)")| A 128 bit unsigned [Integer](https://confluence.ihtsdotools.org/display/DOCRELFMT/Integer+\(data+type\) "Reference term: Integer \(\(data type\)\)"), uniquely identifying this [reference set member](https://confluence.ihtsdotools.org/display/DOCGLOSS/reference+set+member "Glossary link: reference set member").Different versions of a _reference set member_ share the same [id](https://confluence.ihtsdotools.org/display/DOCRELFMT/id+\(field\) "Reference term: id \(\(field\)\)") but have different [effectiveTime](https://confluence.ihtsdotools.org/display/DOCRELFMT/effectiveTime+\(field\) "Reference term: effectiveTime \(\(field\)\)"). This allows a _reference set member_ to be modified or made [inactive](https://confluence.ihtsdotools.org/display/DOCRELFMT/inactive+\(field\) "Reference term: inactive \(field\)") (i.e. removed from the active set) at a specified time.   
| NO| YES (Full /Snapshot)  
[effectiveTime](https://confluence.ihtsdotools.org/display/DOCRELFMT/effectiveTime+\(field\) "Reference term: effectiveTime \(\(field\)\)")| [Time](https://confluence.ihtsdotools.org/display/DOCRELFMT/Time+\(data+type\) "Reference term: Time \(\(data type\)\)")| The inclusive date or time at which this version of the identified [reference set member](https://confluence.ihtsdotools.org/display/DOCGLOSS/reference+set+member "Glossary link: reference set member") became the current version.**Note** : In distribution files the effectiveTime should follow the short ISO date format (_YYYYMM _DD__) and should not include the hours, minutes, seconds or timezone indicator.The current version of this [reference set member](https://confluence.ihtsdotools.org/display/DOCGLOSS/reference+set+member "Glossary link: reference set member") at time _T_ is the version with the most recent [effectiveTime](https://confluence.ihtsdotools.org/display/DOCRELFMT/effectiveTime+\(field\) "Reference term: effectiveTime \(\(field\)\)") prior to or equal to time _T_ .   
| YES| YES (Full)Optional (Snapshot)   
[active](https://confluence.ihtsdotools.org/display/DOCRELFMT/active+\(field\) "Reference term: active \(\(field\)\)")| [Boolean](https://confluence.ihtsdotools.org/display/DOCRELFMT/Boolean+\(data+type\) "Reference term: Boolean \(\(data type\)\)")| The state of the identified [reference set member](https://confluence.ihtsdotools.org/display/DOCGLOSS/reference+set+member "Glossary link: reference set member") as at the specified [effectiveTime](https://confluence.ihtsdotools.org/display/DOCRELFMT/effectiveTime+\(field\) "Reference term: effectiveTime \(\(field\)\)") .If [active](https://confluence.ihtsdotools.org/display/DOCRELFMT/active+\(field\) "Reference term: active \(\(field\)\)") = 1 (true) the [reference set member](https://confluence.ihtsdotools.org/display/DOCGLOSS/reference+set+member "Glossary link: reference set member") is part of the current version of the set, if [active](https://confluence.ihtsdotools.org/display/DOCRELFMT/active+\(field\) "Reference term: active \(\(field\)\)") = 0 (false) the [reference set member](https://confluence.ihtsdotools.org/display/DOCGLOSS/reference+set+member "Glossary link: reference set member") is not part of the current version of the set.   
| YES| NO  
[moduleId](https://confluence.ihtsdotools.org/display/DOCRELFMT/moduleId+\(field\) "Reference term: moduleId \(\(field\)\)")| [SCTID](https://confluence.ihtsdotools.org/display/DOCRELFMT/SCTID+\(data+type\) "Reference term: SCTID \(\(data type\)\)")| Identifies the [SNOMED CT module](https://confluence.ihtsdotools.org/display/DOCGLOSS/SNOMED+CT+module "Glossary link: SNOMED CT module") that contains this [reference set member](https://confluence.ihtsdotools.org/display/DOCGLOSS/reference+set+member "Glossary link: reference set member") as at the specified [effectiveTime](https://confluence.ihtsdotools.org/display/DOCRELFMT/effectiveTime+\(field\) "Reference term: effectiveTime \(\(field\)\)") .The value must be a [subtype](https://confluence.ihtsdotools.org/display/DOCGLOSS/subtype "Glossary link: subtype") of [ 900000000000443000 | Module (core metadata concept)|](http://snomed.info/id/900000000000443000 "900000000000443000 | Module \(core metadata concept\) |") within the metadata [hierarchy](https://confluence.ihtsdotools.org/display/DOCGLOSS/hierarchy "Glossary link: hierarchy").   
| YES| NO  
[refsetId](https://confluence.ihtsdotools.org/display/DOCRELFMT/refsetId+\(field\) "Reference term: refsetId \(\(field\)\)")| [SCTID](https://confluence.ihtsdotools.org/display/DOCRELFMT/SCTID+\(data+type\) "Reference term: SCTID \(\(data type\)\)")| Identifies the [reference set](https://confluence.ihtsdotools.org/display/DOCGLOSS/reference+set "Glossary link: reference set") to which this [reference set member](https://confluence.ihtsdotools.org/display/DOCGLOSS/reference+set+member "Glossary link: reference set member") belongs. In this case, a subtype descendant of: [ 900000000000512005 | Query specification type|](http://snomed.info/id/900000000000512005 "900000000000512005 | Query specification type |") | NO| NO  
[referencedComponentId](https://confluence.ihtsdotools.org/display/DOCRELFMT/referencedComponentId+\(field\) "Reference term: referencedComponentId \(\(field\)\)")| [SCTID](https://confluence.ihtsdotools.org/display/DOCRELFMT/SCTID+\(data+type\) "Reference term: SCTID \(\(data type\)\)")| A reference to the [SNOMED CT component](https://confluence.ihtsdotools.org/display/DOCGLOSS/SNOMED+CT+component "Glossary link: SNOMED CT component") to be included in the [reference set](https://confluence.ihtsdotools.org/display/DOCGLOSS/reference+set "Glossary link: reference set").   
| NO| NO  
[query](https://confluence.ihtsdotools.org/display/WIPRELFMT/query+\(field\))| [String](https://confluence.ihtsdotools.org/display/DOCRELFMT/String+\(data+type\) "Reference term: String \(\(data type\)\)")| The serialised [query](https://confluence.ihtsdotools.org/display/WIPRELFMT/query+\(field\)) that can be used to (re-)generate the [reference set](https://confluence.ihtsdotools.org/display/DOCGLOSS/reference+set "Glossary link: reference set") members.

  * The syntax for specifying the intensional definitions of concept subsets is specified in the [Expression Constraint Language - Specification and Guide](https://confluence.ihtsdotools.org/display/DOCECL/Expression+Constraint+Language+-+Specification+and+Guide).

| YES| NO  
  
# Metadata

The following metadata in the "Foundation metadata [concept](https://confluence.ihtsdotools.org/display/DOCGLOSS/concept "Glossary link: concept") " [hierarchy](https://confluence.ihtsdotools.org/display/DOCGLOSS/hierarchy "Glossary link: hierarchy") supports this [reference set](https://confluence.ihtsdotools.org/display/DOCGLOSS/reference+set "Glossary link: reference set") : 

Table 5.2.1.7-2: Hierarchy of Foundation metadata concept

  
[ 900000000000454005 |Foundation metadata concept|](http://snomed.info/id/900000000000454005 "900000000000454005 | Foundation metadata concept |")   
[ 900000000000455006 |Reference set|](http://snomed.info/id/900000000000455006 "900000000000455006 | Reference set |")   
[ 900000000000512005 |Query specification type|](http://snomed.info/id/900000000000512005 "900000000000512005 | Query specification type |")   
[ 900000000000513000 |Simple query specification|](http://snomed.info/id/900000000000513000 "900000000000513000 | Simple query specification |")   
  

  

# Reference Set Descriptor and Example Data

## Descriptor Template

The table below shows the descriptor that defines the structure of the [ 900000000000512005 | Query specification type reference set|](http://snomed.info/id/900000000000512005 "900000000000512005 | Query specification type reference set |") pattern. 

Table 5.2.1.7-3: Descriptor Template for Query Specification Reference Sets

**refsetId**| **referencedComponentId**| **attributeDescription**| **attributeType**| **attributeOrder**  
---|---|---|---|---  
[ 900000000000456007 | Reference set descriptor|](http://snomed.info/id/900000000000456007 "900000000000456007 | Reference set descriptor |") |  [ 900000000000512005 | Query specification type reference set|](http://snomed.info/id/900000000000512005 "900000000000512005 | Query specification type reference set |") |  [ 900000000000514006 | Generated reference set|](http://snomed.info/id/900000000000514006 "900000000000514006 | Generated reference set |") |  [ 900000000000461009 | Concept type component|](http://snomed.info/id/900000000000461009 "900000000000461009 | Concept type component |") | 0  
[ 900000000000456007 | Reference set descriptor|](http://snomed.info/id/900000000000456007 "900000000000456007 | Reference set descriptor |") |  [ 900000000000512005 | Query specification type reference set|](http://snomed.info/id/900000000000512005 "900000000000512005 | Query specification type reference set |") |  [ 900000000000515007 | Query|](http://snomed.info/id/900000000000515007 "900000000000515007 | Query |") |  [ 900000000000465000 | String|](http://snomed.info/id/900000000000465000 "900000000000465000 | String |") | 1  
  
## Example Data

In the example below, "serialised [query](https://confluence.ihtsdotools.org/display/WIPRELFMT/query+\(field\)) 1" is a text [string](https://confluence.ihtsdotools.org/display/WIPRELFMT/String+\(data+type\)) that can be used to generate members for _[Reference set](https://confluence.ihtsdotools.org/display/DOCGLOSS/Reference+set "Glossary link: Reference set")_ _1_ , which is a simple member [reference set](https://confluence.ihtsdotools.org/display/DOCGLOSS/reference+set "Glossary link: reference set") (without any additional fields within its member records). 

Table 5.2.1.7-4: Example rows from Query Specification Reference Set

**refsetId**| **referencedComponentId**| **query**  
---|---|---  
[ 900000000000513000 | Simple query specification|](http://snomed.info/id/900000000000513000 "900000000000513000 | Simple query specification |") |  [ | Target reference set|](http://snomed.org/fictid# "\(eg:\)  | Target reference set |") |  < [ 19829001 |disorder of lung|](http://snomed.info/id/19829001 "19829001 | disorder of lung |") :  [ 116676008 |associated morphology|](http://snomed.info/id/116676008 "116676008 | associated morphology |") = << [ 79654002 |edema|](http://snomed.info/id/79654002 "79654002 | edema |")  
  
# References

  * See [Expression Constraint Language - Specification and Guide](https://confluence.ihtsdotools.org/display/DOCECL/Expression+Constraint+Language+-+Specification+and+Guide) for details of the language used to specify intensional definitions of concept subsets.

  

