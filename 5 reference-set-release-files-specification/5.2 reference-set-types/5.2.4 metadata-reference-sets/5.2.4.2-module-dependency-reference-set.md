# Module Dependency Reference Set

## Purpose

The [|Module dependency reference set|](http://snomed.info/id/900000000000534007) represents dependencies between different SNOMED CT release modules. In each case, the dependency indicates which [targetEffectiveTime](../../../appendices/appendix-b.-specification-reference-information/t/targeteffectivetime-field.md) of each particular module a given [sourceEffectiveTime](../../../appendices/appendix-b.-specification-reference-information/s/sourceeffectivetime-field.md) of the dependent module requires.

## Data structure

The [900000000000534007 |Module dependency reference set|](http://snomed.info/id/900000000000534007) is a String - String reference set which is used to represent dependencies between modules, taking account of module versioning. Its structure is shown in the following table.

<table data-header-hidden data-full-width="true"><thead><tr><th width="208.015625"></th><th width="94.0859375"></th><th width="252.32421875"></th><th width="89.25390625"></th><th width="144.0390625"></th></tr></thead><tbody><tr><td><strong>Field</strong></td><td><strong>Data type</strong></td><td><strong>Purpose</strong></td><td><strong>Mutable</strong></td><td><strong>Part of Primary Key</strong></td></tr><tr><td>id</td><td>UUID</td><td><p>A 128 bit unsigned Integer, uniquely identifying this reference set member.</p><p>Different versions of a <em>reference set member</em> share the same id but have different effectiveTime. This allows a <em>reference set member</em> to be modified or made inactive (i.e. removed from the active set) at a specified time.</p></td><td><mark style="color:$danger;">NO</mark></td><td><mark style="color:$success;">YES</mark> <br>(Full /Snapshot)</td></tr><tr><td>effectiveTime</td><td>Time</td><td><p>The inclusive date or time at which this version of the identified reference set member became the current version.</p><p><strong>Note</strong>: In distribution files the effectiveTime should follow the short ISO date format (<em>YYYYMMDD</em>) and should not include the hours, minutes, seconds or timezone indicator.</p><p>The current version of this reference set member at time <em>T</em> is the version with the most recent effectiveTime prior to or equal to time <em>T</em>.</p></td><td><mark style="color:$success;">YES</mark> </td><td><p><mark style="color:$success;">YES</mark> <br>(Full)</p><p><mark style="color:$success;">Optional</mark> (Snapshot) </p></td></tr><tr><td>active</td><td>Boolean</td><td><p>The state of the identified reference set member as at the specified effectiveTime .</p><p>If active = 1 (true) the reference set member is part of the current version of the set, if active = 0 (false) the reference set member is not part of the current version of the set.</p><p></p><p><strong>Note</strong>: <em>A module dependency should only be inactivated if it is found to be erroneous.</em></p></td><td><mark style="color:$success;">YES</mark> </td><td><mark style="color:$danger;">NO</mark></td></tr><tr><td>moduleId</td><td>SCTID</td><td><p>Identifies the SNOMED CT module that contains this reference set member as at the specified effectiveTime .</p><p>The value must be a subtype of <a href="http://snomed.info/id/900000000000443000">900000000000443000 |Module (core metadata concept)|</a> within the metadata <a href="https://confluence.ihtsdotools.org/display/DOCGLOSS/hierarchy">hierarchy</a>.</p><p>The moduleId for in the Module Dependency Reference Set represents the source module (i.e. the module declaring a dependency on another module).</p><p><strong>Note</strong>: In all other situations moduleId is mutable. However, in the Module Dependency Reference Set a change to the moduleId would also change the source of the dependency. Therefore, it should <strong>not</strong> be treated as mutable.</p></td><td><mark style="color:$success;">YES</mark> </td><td><mark style="color:$danger;">NO</mark></td></tr><tr><td>refsetId</td><td>SCTID</td><td><p>Identifies the reference set to which this reference set member belongs.</p><p>In this case, always <a href="http://snomed.info/id/900000000000534007">900000000000534007 |Module dependency reference set|</a> as there is only one Module Dependency Reference set.</p></td><td><mark style="color:$danger;">NO</mark></td><td><mark style="color:$danger;">NO</mark></td></tr><tr><td>referencedComponentId</td><td>SCTID</td><td>A reference to the SNOMED CT component to be included in the reference set. This refers to the target of the dependency (i.e. the module on which the module identified by moduleId depends).</td><td><mark style="color:$danger;">NO</mark></td><td><mark style="color:$danger;">NO</mark></td></tr><tr><td>sourceEffectiveTime</td><td>Time</td><td>The effective time of the dependent source module (identified by <a href="../../../appendices/appendix-b.-specification-reference-information/m/moduleid-field.md">moduleId</a>). This specifies a version of that module, consisting of all components that have the same <a href="../../../appendices/appendix-b.-specification-reference-information/m/moduleid-field.md">moduleId</a> as this refset member in their states as at the specified <a href="../../../appendices/appendix-b.-specification-reference-information/t/targeteffectivetime-field.md">targetEffectiveTime</a> .</td><td><mark style="color:$success;">YES</mark> </td><td><mark style="color:$danger;">NO</mark></td></tr><tr><td>targetEffectiveTime</td><td>Time</td><td>The effective time of the target module required to satisfy the dependency (identified by <a href="../../../appendices/appendix-b.-specification-reference-information/r/referencedcomponentid-field.md">referencedComponentId</a>). This specifies a version of that module, consisting of all components with the moduleId specified by referencedComponentId in their states as at the specified <a href="../../../appendices/appendix-b.-specification-reference-information/t/targeteffectivetime-field.md">targetEffectiveTime</a> .</td><td><mark style="color:$success;">YES</mark> </td><td><mark style="color:$danger;">NO</mark></td></tr></tbody></table>

## Rules and Guidance

### Introduction to Modules

Each row in the release files for components and reference set members has a [moduleId](../../../appendices/appendix-b.-specification-reference-information/m/moduleid-field.md). This refers to the module that the component is maintained in. Each module is either part of the SNOMED International Release or part of a single SNOMED CT Extension. The [moduleId](../../../appendices/appendix-b.-specification-reference-information/m/moduleid-field.md) has a partition-id which indicates whether it is part of the SNOMED International Release and, if not, its namespace identifier indicates the SNOMED CT Extension that it belongs to.

A module is simply a collection of SNOMED CT components maintained as a unit by a single organization. It is the organization 's responsibility to organize the components in each extension that it is responsible for into one or more modules, in a way that best fits its business needs.

A module is represented by a descendant of [900000000000443000 |Module|](http://snomed.info/id/900000000000443000) in the metadata hierarchy. The immediate subtype descendants of [900000000000443000 |Module|](http://snomed.info/id/900000000000443000) represent groups of modules maintained by an organization and subtypes of these can be used to arrange that organizations modules into a number of groups. For example, all modules maintained by SNOMED International will be children of [900000000000445007 |SNOMED International maintained module|](http://snomed.info/id/900000000000445007) .

At any point in time a component must be in one, and only one module. It is possible for components and reference set members to be moved between modules (subject to constraints explained elsewhere). In this case, a new row is added to the release file with the same [id](../../../appendices/appendix-b.-specification-reference-information/i/id-field.md) but with a new [effectiveTime](../../../appendices/appendix-b.-specification-reference-information/e/effectivetime-field.md) and a new [moduleId](../../../appendices/appendix-b.-specification-reference-information/m/moduleid-field.md).

### Introduction to Module Dependencies

Each extension must include one or more modules. Each module must be part of either the SNOMED International Release or one and only one extension. A module may not move from one extension to another over time. If components or reference set members in a module are to be moved from an extension to the SNOMED International Release or to another extension, they must either be added to an existing or newly created module maintained by the destination organization.

The [900000000000443000 |Module|](http://snomed.info/id/900000000000443000) [sub-hierarchy](https://confluence.ihtsdotools.org/display/DOCGLOSS/sub-hierarchy) does NOT represent dependencies between module. Instead, module dependencies are modeled using the [900000000000534007 |Module dependency reference set|](http://snomed.info/id/900000000000534007).

At the point of release, if any component within a module has changed, then a new row must be added to the [|Module dependency reference set|](http://snomed.info/id/900000000000534007) for each dependency of that module. The [effectiveTime](../../../appendices/appendix-b.-specification-reference-information/e/effectivetime-field.md) of the added rows must set to the date of the new release. The updated [|Module dependency reference set|](http://snomed.info/id/900000000000534007) records indicate that some components within the module have been updated in this release. If there have been no additions, updates or inactivations of components or reference set members within a module, then a new [|Module dependency reference set|](http://snomed.info/id/900000000000534007) records need not be added unless there is a requirement to declare that the unchanged module is compatible with a later release of the module(s) on which it dependents.

### Identifying and Versioning Module Dependencies

#### id

The recommended practice is for the [refset.id](../../../appendices/appendix-b.-specification-reference-information/r/refsetid-field.md) column to contain the same identifier for all versions of the dependencies between the same pair of modules. This approach means that at any given time only one version of each module has effective dependencies. The dependencies of earlier versions can be reviewed by reviewing a snapshot for the effectiveTime of the earlier release.

{% hint style="info" %}
**Value of the id column**

An alternative approach has been suggested by some people in which a new identifier is allocated to each dependency of each module. This would then mean that all past dependencies would be visible in a snapshot view. It would also mean that it would be possible release updated dependencies for an existing module version while also releasing more up-to-date versions of the same module with different dependencies. This added flexibility comes at the price of additional complexity and for the time-being the International Release modules continue to use the simpler approach in which each new version of a dependency supersedes the dependency between earlier versions of the same pair of modules.
{% endhint %}

#### effectiveTime

The effectiveTime of at least one row for each pair of modules should be the same as the sourceEffectiveTime. Otherwise, there will be a period of time when a snapshot view will not show the dependencies. However, it is theoretically possible for an additional row to be added with a later effectiveTime in cases where an otherwise unchanged release of an extension, declares itself to be compatible with an updated release of the target module (in this case the effectiveTime and targetEffectiveTime are changed but the sourceEffectiveTime remains unchanged.

#### active

A module dependency only needs to be inactivated if the dependency is found to be erroneous. This is because, the module dependency is specific to a particular version of the source and target module. Therefore, if that dependency was valid at the outset it remains valid indefinitely in respect of those specified module versions, even if the dependencies between subsequent versions differ.

#### refsetId

Module version dependencies are represented using a single [900000000000534007 |Module dependency reference set|](http://snomed.info/id/900000000000534007). Thus all module dependency rows have the same refsetId ([900000000000534007 |Module dependency reference set (foundation metadata concept)|](http://snomed.info/id/900000000000534007)).

It is the responsibility of the organization owning and maintaining a dependent module to identify all modules on which it depends. They do this by adding rows to the [900000000000534007 |Module dependency reference set|](http://snomed.info/id/900000000000534007) within the dependent module. Because these added member must be in the dependent module, the moduleId of the reference set member record is also the identifier of the dependent (source) module.

### Module Identification

#### Source Module (moduleId)

The [moduleId](../../../appendices/appendix-b.-specification-reference-information/m/moduleid-field.md) column not only indicates that this reference set member is in the specified module, it also indicates that this is the module that is the source of the dependency. As a result, in this reference set the moduleId column is immutable (i.e Mutable=NO). This is an exception to the usual rule and implies that a member of this reference set cannot move from one module to another.

#### Target Module (referencedComponentId)

The target module on which the source module depends is identified by the [referencedComponentId](../../../appendices/appendix-b.-specification-reference-information/r/referencedcomponentid-field.md). Like the source module this is also immutable and this implies that if a module ceases to be dependent on another module, a new row inactivating the dependency can be added but the same member cannot be used to represent a different dependency (even if that dependency is a direct replacement of the inactivated dependency). However as noted above,

A module version may depend on one or more other module versions, and many module versions may have a dependency on a single module version. Cyclic module version dependencies are not allowed. If module-A depends on module-B, then module-B cannot depend on module-A.

Dependencies are not transitive and this means that dependencies cannot be inferred from a chain of dependencies. If module-A depends on module-B and module-B depends on module-C, the dependency of module-A on module-C must still be stated explicitly.

Any release should consist of a set of module versions that are certified as being compatible. Each release should also identify other module versions that it is dependent on even when these are outside the scope of the release. For example, the dependencies of modules in an Extension on the International Release must be stated.

Dependencies are specified between module versions, not just dependencies between modules. Therefore, it is possible to specify a dependency from a module released on one date to an earlier version of another module. The version of the dependent module is specified by the [sourceEffectiveTime](../../../appendices/appendix-b.-specification-reference-information/s/sourceeffectivetime-field.md) and the version of the module on which it depends is specified by the [targetEffectiveTime](../../../appendices/appendix-b.-specification-reference-information/t/targeteffectivetime-field.md).

## Metadata

The following metadata in the "Foundation metadata [concept](https://confluence.ihtsdotools.org/display/DOCGLOSS/concept) " [hierarchy](https://confluence.ihtsdotools.org/display/DOCGLOSS/hierarchy) supports this [reference set](https://confluence.ihtsdotools.org/display/DOCGLOSS/reference+set) :

<figure><img src="../../../5%20reference-set-release-files-specification/5.2%20reference-set-types/5.2.4%20metadata-reference-sets/plugins/servlet/confluence/placeholder/unknown-macro" alt=""><figcaption><p>[ 900000000000454005 |Foundation metadata concept|](http://snomed.info/id/900000000000454005 "900000000000454005 | Foundation metadata concept |")</p></figcaption></figure>

[900000000000455006 |Reference set|](http://snomed.info/id/900000000000455006)\
[900000000000534007 |Module dependency|](http://snomed.info/id/900000000000534007)

## Reference Set Descriptor and Example Data

### Descriptor

The table below shows the descriptor that defines the structure of the [900000000000534007 | Module dependency reference set|](http://snomed.info/id/900000000000534007) .

<figure><img src="../../../5%20reference-set-release-files-specification/5.2%20reference-set-types/5.2.4%20metadata-reference-sets/plugins/servlet/confluence/placeholder/unknown-macro" alt=""><figcaption><p><strong>refsetId</strong>| <strong>referencedComponentId (Referenced component)</strong>| <strong>attributeDescription (Attribute description)</strong>| <strong>attributeType (Attribute type)</strong>| <strong>attributeOrder (Attribute order)</strong>|</p></figcaption></figure>

\|---|---|---|---|---\
\[ 900000000000456007 | Reference set descriptor|]\(http://snomed.info/id/900000000000456007 "900000000000456007 | Reference set descriptor |") | \[ 900000000000534007 | Module dependency|]\(http://snomed.info/id/900000000000534007 "900000000000534007 | Module dependency |") | \[ 900000000000535008 | Dependency target|]\(http://snomed.info/id/900000000000535008 "900000000000535008 | Dependency target |") | \[ 900000000000461009 | Concept type component|]\(http://snomed.info/id/900000000000461009 "900000000000461009 | Concept type component |") | 0|

[900000000000456007 | Reference set descriptor|](http://snomed.info/id/900000000000456007) | [900000000000534007 | Module dependency|](http://snomed.info/id/900000000000534007) | [900000000000536009 | Source effective time|](http://snomed.info/id/900000000000536009) | [900000000000475002 | Time|](http://snomed.info/id/900000000000475002) | 1|

[900000000000456007 | Reference set descriptor|](http://snomed.info/id/900000000000456007) | [900000000000534007 | Module dependency|](http://snomed.info/id/900000000000534007) | [900000000000537000 | Target effective time|](http://snomed.info/id/900000000000537000) | [900000000000475002 | Time|](http://snomed.info/id/900000000000475002) | 2|

Note: The table above omits the initial four columns of data present in the release file. These follow the standards versioning pattern [id](https://confluence.ihtsdotools.org/display/DOCRELFMT/id+\(field\)), [effectiveTime](https://confluence.ihtsdotools.org/display/DOCRELFMT/effectiveTime+\(field\)), [active](https://confluence.ihtsdotools.org/display/DOCRELFMT/active+\(field\)), [active](https://confluence.ihtsdotools.org/display/DOCRELFMT/active+\(field\)). Additionally, to aid understanding, the table above also shows the [term](https://confluence.ihtsdotools.org/display/DOCGLOSS/term) from one of the [descriptions](https://confluence.ihtsdotools.org/display/DOCGLOSS/description) associated with each of the identified [concept](https://confluence.ihtsdotools.org/display/DOCGLOSS/concept). The release file only contains the [identifier](https://confluence.ihtsdotools.org/display/DOCGLOSS/identifier).

### Example Data

Example The table below holds example entries for the [900000000000534007 | Module dependency reference set|](http://snomed.info/id/900000000000534007) in a [snapshot view](https://confluence.ihtsdotools.org/display/DOCGLOSS/snapshot+view) of the January 2014 [SNOMED CT International Release](https://confluence.ihtsdotools.org/display/DOCGLOSS/SNOMED+CT+International+Release) .

This [SNOMED CT International Release](https://confluence.ihtsdotools.org/display/DOCGLOSS/SNOMED+CT+International+Release) contains three modules:

* [900000000000012004 | SNOMED CT model component|](http://snomed.info/id/900000000000012004) which has no dependencies;
* [900000000000207008 | SNOMED CT core|](http://snomed.info/id/900000000000207008) which depends on the [900000000000012004 | SNOMED CT model component|](http://snomed.info/id/900000000000012004) ; and
* [449080006 | SNOMED CT to ICD-10 rule-based mapping module|](http://snomed.info/id/449080006) which depends on both the other modules.

In this case all the 2014-01-31 modules depend on 2014-01-31 versions of the other modules. However, in some case a module may depend on an earlier version of another model (e.g. an extension module may be releases after the [SNOMED CT International Release](https://confluence.ihtsdotools.org/display/DOCGLOSS/SNOMED+CT+International+Release) to which it applies).

Dependencies are not transitive. The fact that [449080006 | SNOMED CT to ICD-10 rule-based mapping module|](http://snomed.info/id/449080006) is dependent on [900000000000207008 | SNOMED CT core|](http://snomed.info/id/900000000000207008) may seem to imply a dependency on [900000000000012004 | SNOMED CT model component|](http://snomed.info/id/900000000000012004) . However, in practice all dependencies must be explicitly specified, not just immediate dependencies.

<figure><img src="../../../5%20reference-set-release-files-specification/5.2%20reference-set-types/5.2.4%20metadata-reference-sets/plugins/servlet/confluence/placeholder/unknown-macro" alt=""><figcaption><p><strong>moduleId</strong>| <strong>refsetId</strong>| <strong>referencedComponentId (Dependency target)</strong>| <strong>sourceEffectiveTime (Source effective time)</strong>| <strong>targetEffectiveTime (Target effective time)</strong></p></figcaption></figure>

\|---|---|---|---\
\[ 900000000000207008 | SNOMED CT core|]\(http://snomed.info/id/900000000000207008 "900000000000207008 | SNOMED CT core |") | \[ 900000000000534007 | Module dependency|]\(http://snomed.info/id/900000000000534007 "900000000000534007 | Module dependency |") | \[ 900000000000012004 | SNOMED CT model component|]\(http://snomed.info/id/900000000000012004 "900000000000012004 | SNOMED CT model component |") | 20140131| 20140131\
\[ 449080006 | SNOMED CT to ICD-10 rule-based mapping module|]\(http://snomed.info/id/449080006 "449080006 | SNOMED CT to ICD-10 rule-based mapping module |") | \[ 900000000000534007 | Module dependency|]\(http://snomed.info/id/900000000000534007 "900000000000534007 | Module dependency |") | \[ 900000000000012004 | SNOMED CT model component|]\(http://snomed.info/id/900000000000012004 "900000000000012004 | SNOMED CT model component |") | 20140131| 20140131\
\[ 449080006 | SNOMED CT to ICD-10 rule-based mapping module|]\(http://snomed.info/id/449080006 "449080006 | SNOMED CT to ICD-10 rule-based mapping module |") | \[ 900000000000534007 | Module dependency|]\(http://snomed.info/id/900000000000534007 "900000000000534007 | Module dependency |") | \[ 900000000000207008 | SNOMED CT core|]\(http://snomed.info/id/900000000000207008 "900000000000207008 | SNOMED CT core |") | 20140131| 20140131
